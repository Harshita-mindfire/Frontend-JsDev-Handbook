<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/Frontend-JsDev-Handbook/favicon.ico"/><title>Server and Client Composition Patterns</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Personal Knowledge Space"/><meta property="og:title" content="Server and Client Composition Patterns"/><meta property="og:description" content="Personal Knowledge Space"/><meta property="og:url" content="https://Harshita-mindfire.github.io/Frontend-JsDev-Handbook/notes/u7xur0cxsnbvg51rquey5ew/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="8/19/2025"/><meta property="article:modified_time" content="8/19/2025"/><link rel="canonical" href="https://Harshita-mindfire.github.io/Frontend-JsDev-Handbook/notes/u7xur0cxsnbvg51rquey5ew/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/Frontend-JsDev-Handbook/_next/static/css/d70c9756212654c3.css" as="style"/><link rel="stylesheet" href="/Frontend-JsDev-Handbook/_next/static/css/d70c9756212654c3.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/Frontend-JsDev-Handbook/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/Frontend-JsDev-Handbook/_next/static/chunks/webpack-7ae598a7290a332d.js" defer=""></script><script src="/Frontend-JsDev-Handbook/_next/static/chunks/framework-28c999baf2863c3d.js" defer=""></script><script src="/Frontend-JsDev-Handbook/_next/static/chunks/main-99db8cbbcbcf3a6e.js" defer=""></script><script src="/Frontend-JsDev-Handbook/_next/static/chunks/pages/_app-c8281554a3681fc9.js" defer=""></script><script src="/Frontend-JsDev-Handbook/_next/static/chunks/935-4dee79e80b8641c6.js" defer=""></script><script src="/Frontend-JsDev-Handbook/_next/static/chunks/6-50972def09142ee2.js" defer=""></script><script src="/Frontend-JsDev-Handbook/_next/static/chunks/pages/notes/%5Bid%5D-78d472fa3b924116.js" defer=""></script><script src="/Frontend-JsDev-Handbook/_next/static/xOzf4DPnOhx7yXDruly4o/_buildManifest.js" defer=""></script><script src="/Frontend-JsDev-Handbook/_next/static/xOzf4DPnOhx7yXDruly4o/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout" style="margin-top:64px;display:flex;flex-direction:row"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><main class="ant-layout-content side-layout-main" style="max-width:1200px;min-width:0;display:block"><div style="padding:0 24px"><div class="main-content" role="main"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="server-and-client-composition-patterns">Server and Client Composition Patterns<a aria-hidden="true" class="anchor-heading icon-link" href="#server-and-client-composition-patterns"></a></h1>
<p>Scenarios where we can use client or server components.</p>
<h2 id="server-components">Server components<a aria-hidden="true" class="anchor-heading icon-link" href="#server-components"></a></h2>
<ul>
<li>fetching data</li>
<li>accessing backend resources directly</li>
<li>keeping sensitive information (like access tokens and API keys) secure on the server</li>
<li>handling large dependencies server-side - which means less JavaScript for your users to download</li>
</ul>
<h2 id="client-components">Client components<a aria-hidden="true" class="anchor-heading icon-link" href="#client-components"></a></h2>
<ul>
<li>adding interactivity</li>
<li>handling event listeners (like onClick(), onChange(), etc.)</li>
<li>managing state and lifecycle effects (using hooks like useState(), useReducer(), useEffect()) </li>
<li>working with browser-specific APIs </li>
<li>implementing custom hooks</li>
<li>Using React class components</li>
</ul>
<p>But the differentiation isn't that black and white always. <strong>Here are some patterns to keep in mind:</strong></p>
<h1 id="server-component-patterns">Server component patterns<a aria-hidden="true" class="anchor-heading icon-link" href="#server-component-patterns"></a></h1>
<h2 id="server-only-code">Server-only code<a aria-hidden="true" class="anchor-heading icon-link" href="#server-only-code"></a></h2>
<ul>
<li>Some code is specifically designed to run exclusively on the server</li>
<li>Think about modules or functions that work with multiple libraries, handle environment variables, communicate directly with databases, or process sensitive information.</li>
<li>Since JavaScript modules can be shared between Server and Client Components, code meant for the server could accidentally find its way to the client</li>
<li>This is bad news as it can bloat your JavaScript bundle, expose your secret keys, database queries, and sensitive business logic</li>
</ul>
<p>It's super important to keep server-only code separate from client-side code</p>
<blockquote>
<p>use <strong><em>server-only</em></strong> package. This throws a build time error if a someone accidentally imports server code into Client component.</p>
</blockquote>
<pre class="language-tsx"><code class="language-tsx"><span class="token keyword module">import</span> <span class="token string">"server-only"</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="third-party-packages">Third party packages<a aria-hidden="true" class="anchor-heading icon-link" href="#third-party-packages"></a></h2>
<ul>
<li>Server Components have introduced an exciting new paradigm in React, and the ecosystem is evolving to keep up</li>
<li>Third-party packages are starting to add the "use client" directive to components that need client-side features, making it clear where they should run</li>
<li>Many npm packages haven't made this transition yet</li>
<li>This means while they work fine in Client Components, they might break or fail completely in Server Components</li>
<li>We can wrap the third-party components that need client-side features in our own Client Components: i.e, create a client component "use client" and use the third party package here, import this client component in server component instead of directly writing code of such third party packages in server component.</li>
</ul>
<h2 id="context-providers">Context providers<a aria-hidden="true" class="anchor-heading icon-link" href="#context-providers"></a></h2>
<p>Context providers typically live near the root of an application to share global state and logic. For example, your application's theme.</p>
<p>However, React context isn't supported in Server Components.</p>
<p>If you try to create a context at your application's root, you'll run into an error. <strong>The solution is to create your context and render its provider inside a dedicated Client Component</strong></p>
<ul>
<li>Extracting the context provider and wrapping other server components as its children does not turn those server components into client components. Weâ€™ll dive deeper into this idea later when discussing client-side patterns.</li>
</ul>
<h1 id="client-component-patterns">Client component patterns<a aria-hidden="true" class="anchor-heading icon-link" href="#client-component-patterns"></a></h1>
<h2 id="client-only-code">Client only code<a aria-hidden="true" class="anchor-heading icon-link" href="#client-only-code"></a></h2></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#server-components" title="Server components">Server components</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#client-components" title="Client components">Client components</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#server-component-patterns" title="Server component patterns">Server component patterns</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#server-only-code" title="Server-only code">Server-only code</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#third-party-packages" title="Third party packages">Third party packages</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#context-providers" title="Context providers">Context providers</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#client-component-patterns" title="Client component patterns">Client component patterns</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#client-only-code" title="Client only code">Client only code</a></div></div></div></div></div></div></div></div></div></div></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></main></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"u7xur0cxsnbvg51rquey5ew","title":"Server and Client Composition Patterns","desc":"","updated":1755620615946,"created":1755620615946,"custom":{},"fname":"learning.nextjs.rendering.react-server-components.server-and-client-composition-patterns","type":"note","vault":{"fsPath":".","selfContained":true,"name":"Harshita-notes","sync":"sync"},"contentHash":"94a88dcdd37a036072259468b6c613ad","links":[],"anchors":{"server-components":{"type":"header","text":"Server components","value":"server-components","line":9,"column":0,"depth":2},"client-components":{"type":"header","text":"Client components","value":"client-components","line":15,"column":0,"depth":2},"server-component-patterns":{"type":"header","text":"Server component patterns","value":"server-component-patterns","line":27,"column":0,"depth":1},"server-only-code":{"type":"header","text":"Server-only code","value":"server-only-code","line":29,"column":0,"depth":2},"third-party-packages":{"type":"header","text":"Third party packages","value":"third-party-packages","line":46,"column":0,"depth":2},"context-providers":{"type":"header","text":"Context providers","value":"context-providers","line":58,"column":0,"depth":2},"client-component-patterns":{"type":"header","text":"Client component patterns","value":"client-component-patterns","line":68,"column":0,"depth":1},"client-only-code":{"type":"header","text":"Client only code","value":"client-only-code","line":70,"column":0,"depth":2}},"children":[],"parent":"ubgj4b3onoq9pj080dri1nj","data":{}},"body":"\u003ch1 id=\"server-and-client-composition-patterns\"\u003eServer and Client Composition Patterns\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#server-and-client-composition-patterns\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cp\u003eScenarios where we can use client or server components.\u003c/p\u003e\n\u003ch2 id=\"server-components\"\u003eServer components\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#server-components\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003efetching data\u003c/li\u003e\n\u003cli\u003eaccessing backend resources directly\u003c/li\u003e\n\u003cli\u003ekeeping sensitive information (like access tokens and API keys) secure on the server\u003c/li\u003e\n\u003cli\u003ehandling large dependencies server-side - which means less JavaScript for your users to download\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"client-components\"\u003eClient components\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#client-components\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eadding interactivity\u003c/li\u003e\n\u003cli\u003ehandling event listeners (like onClick(), onChange(), etc.)\u003c/li\u003e\n\u003cli\u003emanaging state and lifecycle effects (using hooks like useState(), useReducer(), useEffect()) \u003c/li\u003e\n\u003cli\u003eworking with browser-specific APIs \u003c/li\u003e\n\u003cli\u003eimplementing custom hooks\u003c/li\u003e\n\u003cli\u003eUsing React class components\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eBut the differentiation isn't that black and white always. \u003cstrong\u003eHere are some patterns to keep in mind:\u003c/strong\u003e\u003c/p\u003e\n\u003ch1 id=\"server-component-patterns\"\u003eServer component patterns\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#server-component-patterns\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003ch2 id=\"server-only-code\"\u003eServer-only code\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#server-only-code\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eSome code is specifically designed to run exclusively on the server\u003c/li\u003e\n\u003cli\u003eThink about modules or functions that work with multiple libraries, handle environment variables, communicate directly with databases, or process sensitive information.\u003c/li\u003e\n\u003cli\u003eSince JavaScript modules can be shared between Server and Client Components, code meant for the server could accidentally find its way to the client\u003c/li\u003e\n\u003cli\u003eThis is bad news as it can bloat your JavaScript bundle, expose your secret keys, database queries, and sensitive business logic\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIt's super important to keep server-only code separate from client-side code\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003euse \u003cstrong\u003e\u003cem\u003eserver-only\u003c/em\u003e\u003c/strong\u003e package. This throws a build time error if a someone accidentally imports server code into Client component.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cpre class=\"language-tsx\"\u003e\u003ccode class=\"language-tsx\"\u003e\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"server-only\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"third-party-packages\"\u003eThird party packages\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#third-party-packages\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eServer Components have introduced an exciting new paradigm in React, and the ecosystem is evolving to keep up\u003c/li\u003e\n\u003cli\u003eThird-party packages are starting to add the \"use client\" directive to components that need client-side features, making it clear where they should run\u003c/li\u003e\n\u003cli\u003eMany npm packages haven't made this transition yet\u003c/li\u003e\n\u003cli\u003eThis means while they work fine in Client Components, they might break or fail completely in Server Components\u003c/li\u003e\n\u003cli\u003eWe can wrap the third-party components that need client-side features in our own Client Components: i.e, create a client component \"use client\" and use the third party package here, import this client component in server component instead of directly writing code of such third party packages in server component.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"context-providers\"\u003eContext providers\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#context-providers\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eContext providers typically live near the root of an application to share global state and logic. For example, your application's theme.\u003c/p\u003e\n\u003cp\u003eHowever, React context isn't supported in Server Components.\u003c/p\u003e\n\u003cp\u003eIf you try to create a context at your application's root, you'll run into an error. \u003cstrong\u003eThe solution is to create your context and render its provider inside a dedicated Client Component\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eExtracting the context provider and wrapping other server components as its children does not turn those server components into client components. Weâ€™ll dive deeper into this idea later when discussing client-side patterns.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"client-component-patterns\"\u003eClient component patterns\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#client-component-patterns\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003ch2 id=\"client-only-code\"\u003eClient only code\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#client-only-code\"\u003e\u003c/a\u003e\u003c/h2\u003e","noteIndex":{"id":"dlb5bmx7v8f6otsgongz4vx","title":"Hi","desc":"","updated":1663067414354,"created":1648190029829,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":".","selfContained":true,"name":"Harshita-notes","sync":"sync"},"contentHash":"5e58da66991a53ed4cf17d0cade77fe6","links":[{"type":"wiki","from":{"fname":"root","id":"dlb5bmx7v8f6otsgongz4vx","vaultName":"Harshita-notes"},"value":"user.tharshita13","alias":"@tharshita13","position":{"start":{"line":15,"column":12,"offset":433},"end":{"line":15,"column":24,"offset":445},"indent":[]},"xvault":false,"to":{"fname":"user.tharshita13"}}],"anchors":{"contacts":{"type":"header","text":"Contacts","value":"contacts","line":13,"column":0,"depth":2}},"children":["trkx8xrg7g2fm023ez4ldqj","c8csxid3zoghxorepwcrami","urj8q1uq98o3upmgbt2qxns","ykyv5ng8vb44dx8wlchugby","qfxhhwhykm8ml24xxlu67v3","fmv0zz06pgij3bozzx9zes9"],"parent":null,"data":{},"body":"\nHi,\nWelcome to Harshita's Digital Garden ðŸŒ±\nI'm Harshita Joshi. I'm a software engineer.\nWhen not at the computer, I play ukulele, do yoga, study [German](https://harshita-mindfire.github.io/german-for-beginners/) and wonder about having numerous pets.\n\n## Contacts\n\nYou can find and contact me in the following places\n\n- Email: tharshita13@gmail.com\n\n- Github: [Harshita-mindfire](https://github.com/Harshita-mindfire)\n\n- Medium: [@tharshita13](https://medium.com/@tharshita13)\n\n- LinkedIn: [Harshita Joshi](https://www.linkedin.com/in/harshita-joshi-030b29118/)\n\n- Instagram: [imharshita07](https://www.instagram.com/imharshita07/)\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true,"enableSelfContainedVaults":true,"enableEngineV3":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":".","selfContained":true,"name":"Harshita-notes","sync":"sync"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"task","dateFormat":"y.MM.dd","addBehavior":"asOwnDomain","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"taskCompleteStatus":["done","x"],"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableFullHierarchyNoteTitle":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Digital Garden","description":"Personal Knowledge Space"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"search","siteUrl":"https://Harshita-mindfire.github.io","assetsPrefix":"/Frontend-JsDev-Handbook","siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"u7xur0cxsnbvg51rquey5ew"},"buildId":"xOzf4DPnOhx7yXDruly4o","assetPrefix":"/Frontend-JsDev-Handbook","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>