<h1 id="security">Security<a aria-hidden="true" class="anchor-heading icon-link" href="#security"></a></h1>
<ul>
<li><a href="https://owasp.org/www-project-top-ten/">OWASP Top Ten Vulnerabilities</a></li>
</ul>
<h2 id="owaspopen-web-application-security-project-">OWASP(Open Web Application Security Project )<a aria-hidden="true" class="anchor-heading icon-link" href="#owaspopen-web-application-security-project-"></a></h2>
<p>The OWASP (Open Web Application Security Project) Top Ten is a widely recognized list of the most critical web application security risks. These vulnerabilities represent common issues that can lead to security breaches if not properly addressed.</p>
<h3 id="injection"><strong>Injection</strong>:<a aria-hidden="true" class="anchor-heading icon-link" href="#injection"></a></h3>
<p>This occurs when untrusted data is sent to an interpreter as part of a command or query, leading to unintended actions. An attacker can manipulate input fields to execute arbitrary code.</p>
<h4 id="example">Example<a aria-hidden="true" class="anchor-heading icon-link" href="#example"></a></h4>
<ul>
<li>
<p><strong>SQL Injection</strong> - Attacker inserts malicious SQL code into a login form, gaining unauthorized access to a database.</p>
<ul>
<li>SQL Injection Based on <strong>1=1</strong> is Always True.</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Users <span class="token keyword">WHERE</span> UserId <span class="token operator">=</span> <span class="token number">105</span> <span class="token operator">OR</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
</code></pre>
<ul>
<li>SQL Injection Based on Batched SQL Statements</li>
</ul>
<pre class="language-js"><code class="language-js">txtUserId <span class="token operator">=</span> <span class="token function">getRequestString</span><span class="token punctuation">(</span><span class="token string">'UserId'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
txtSQL <span class="token operator">=</span> <span class="token string">'SELECT * FROM Users WHERE UserId = '</span> <span class="token operator">+</span> txtUserId<span class="token punctuation">;</span>
<span class="token comment">//What is user entered 105; DROP TABLE Suppliers in input box for UserId? The txtSQL will result in:</span>
<span class="token constant">SELECT</span> <span class="token operator">*</span> <span class="token constant">FROM</span> <span class="token maybe-class-name">Users</span> <span class="token constant">WHERE</span> <span class="token maybe-class-name">UserId</span> <span class="token operator">=</span> <span class="token number">105</span><span class="token punctuation">;</span> <span class="token constant">DROP</span> <span class="token constant">TABLE</span> <span class="token maybe-class-name">Suppliers</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="prevention">Prevention<a aria-hidden="true" class="anchor-heading icon-link" href="#prevention"></a></h4>
<ul>
<li>using <strong>PREPARED STATEMENTS</strong>: The idea is very simple - the query and the data are sent to the database server separately.</li>
</ul>
</li>
</ul>
<p>The <em>mysql2</em> library handles the parameter binding and escaping internally, ensuring that each value is treated as <strong>data</strong>, not <strong>executable code</strong>.</p>
<pre class="language-js"><code class="language-js">app<span class="token punctuation">.</span><span class="token method function property-access">post</span><span class="token punctuation">(</span><span class="token string">'/batchInsert'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> usersToInsert <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">users</span><span class="token punctuation">;</span> <span class="token comment">// An array of user objects</span>

  <span class="token comment">// Using a prepared statement for batch insert</span>
  <span class="token keyword">const</span> sql <span class="token operator">=</span> <span class="token string">'INSERT INTO users (username, email) VALUES (?, ?)'</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> values <span class="token operator">=</span> usersToInsert<span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token parameter">user</span> <span class="token arrow operator">=></span> <span class="token punctuation">[</span>user<span class="token punctuation">.</span><span class="token property-access">username</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token property-access">email</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  connection<span class="token punctuation">.</span><span class="token method function property-access">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">[</span>values<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> results</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token spread operator">...</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre>
<h3 id="identification-and-authentication-failures-previously-broken-authentication">Identification and Authentication Failures (previously, Broken Authentication)<a aria-hidden="true" class="anchor-heading icon-link" href="#identification-and-authentication-failures-previously-broken-authentication"></a></h3>
<p>Flaws in authentication and session management can lead to unauthorized access to accounts and sensitive data.</p>
<h4 id="example-1">example<a aria-hidden="true" class="anchor-heading icon-link" href="#example-1"></a></h4>
<ul>
<li><strong>Credential stuffing</strong> - Attackers use previously stolen credentials to gain unauthorized access to user accounts on various sites.</li>
</ul>
<h4 id="prevention-1">Prevention<a aria-hidden="true" class="anchor-heading icon-link" href="#prevention-1"></a></h4>
<ul>
<li>Implement strong password policies, enable multi-factor authentication (MFA), use secure session management, and enforce secure password storage (e.g., bcrypt hashing).</li>
</ul>
<h3 id="cryptographic-failures-previously--sensitive-data-exposure">Cryptographic Failures (previously : Sensitive Data Exposure)<a aria-hidden="true" class="anchor-heading icon-link" href="#cryptographic-failures-previously--sensitive-data-exposure"></a></h3>
<p>This vulnerability involves inadequate protection of sensitive data, such as passwords, credit card numbers, and personal information.</p>
<h4 id="example-2">Example:<a aria-hidden="true" class="anchor-heading icon-link" href="#example-2"></a></h4>
<ul>
<li><strong>Insecure storage</strong> - Storing passwords in plain text instead of hashing them, making it easy for attackers to steal user credentials.</li>
</ul>
<h4 id="prevention-2">Prevention<a aria-hidden="true" class="anchor-heading icon-link" href="#prevention-2"></a></h4>
<ul>
<li>Encrypt sensitive data at rest and during transmission (use HTTPS).</li>
<li>Avoid storing sensitive information unless absolutely necessary.</li>
<li>Implement proper access controls to limit who can access sensitive data.</li>
<li>Disable caching for response that contain sensitive data.</li>
</ul>
<h3 id="insecure-design">Insecure Design<a aria-hidden="true" class="anchor-heading icon-link" href="#insecure-design"></a></h3>
<p><em>Scenario</em>: A chain of cinemas provides discounts for group bookings but mandates a deposit when the group size exceeds fifteen attendees. Malicious actors could analyze this process and attempt to determine whether it's possible to reserve six hundred seats across all cinemas in just a few requests. This could potentially lead to a significant financial loss.</p>
<h3 id="broken-access-control"><strong>Broken Access Control</strong>:<a aria-hidden="true" class="anchor-heading icon-link" href="#broken-access-control"></a></h3>
<p>Improper enforcement of restrictions on what authenticated users can do can lead to unauthorized actions.</p>
<ul>
<li>Access control enforces policy such that users cannot act outside of their intended permissions</li>
</ul>
<h4 id="example-3">Example:<a aria-hidden="true" class="anchor-heading icon-link" href="#example-3"></a></h4>
<ul>
<li>Permitting viewing or editing someone else's account, by providing its unique identifier (insecure direct object references)</li>
</ul>
<p><em>Scenario</em>: <em>An application allows users to view their own account details by navigating to <a href="https://example.com/profile?user_id=123">https://example.com/profile?user_id=123</a>. The attacker changes the user_id parameter to access another user's account.</em></p>
<ul>
<li>CORS misconfiguration allows API access from unauthorized/untrusted origins.</li>
</ul>
<h4 id="prevention-3">Prevention<a aria-hidden="true" class="anchor-heading icon-link" href="#prevention-3"></a></h4>
<ul>
<li>Except for public resources, deny access by default.</li>
<li>Stateful session identifiers should be invalidated on the server after logout. Stateless JWT tokens should rather be short-lived so that the window of opportunity for an attacker is minimized. For longer lived JWTs it's highly recommended to follow the OAuth standards to revoke access.</li>
</ul>
<h3 id="security-misconfiguration"><strong>Security Misconfiguration</strong>:<a aria-hidden="true" class="anchor-heading icon-link" href="#security-misconfiguration"></a></h3>
<p>Failure to securely configure settings and security controls can expose sensitive data or provide attackers with unnecessary access.</p>
<h4 id="example-4">Example:<a aria-hidden="true" class="anchor-heading icon-link" href="#example-4"></a></h4>
<ul>
<li><em>Default credentials</em> - Leaving default usernames and passwords for admin accounts, enabling attackers to easily access and control the application.</li>
</ul>
<p><em>Scenario</em>: An application's admin panel has default credentials (admin/admin). The attacker uses these credentials to log in and compromise the system.</p>
<p>In 2023 guidelines, XXE is also under this.</p>
<h4 id="xml-external-entity-xxe">XML External Entity (XXE)<a aria-hidden="true" class="anchor-heading icon-link" href="#xml-external-entity-xxe"></a></h4>
<p>XXE security vulnerability allows a attacker to inject unsafe XML entities into a web application that processes XML data. Attackers can exploit this to read files on the server.
eg:</p>
<ul>
<li>Attacker submits malicious XML input that references a sensitive file, gaining unauthorized access to its content.</li>
</ul>
<h3 id="cross-site-scripting-xss"><strong>Cross-Site Scripting (XSS)</strong>:<a aria-hidden="true" class="anchor-heading icon-link" href="#cross-site-scripting-xss"></a></h3>
<p>XSS occurs when an application includes untrusted data in a web page, allowing attackers to execute malicious scripts in the context of a user's browser.</p>
<h4 id="example-5">Example:<a aria-hidden="true" class="anchor-heading icon-link" href="#example-5"></a></h4>
<p>in an input feild, that directly gets added to the DOM, attacker might add a script to execute something like:</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span>
  <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value javascript language-javascript"><span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">location</span><span class="token punctuation">.</span><span class="token property-access">href</span> <span class="token operator">=</span> 
<span class="token string">'http://malicious-site.com'</span></span><span class="token punctuation">"</span></span></span>
<span class="token punctuation">></span></span>
  Get offers
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span>
</code></pre>
<h4 id="prevention-4">Prevention<a aria-hidden="true" class="anchor-heading icon-link" href="#prevention-4"></a></h4>
<ul>
<li>implement non-bypassable Content Security Policy(CSP) policy. CSP specifies which sources of content are considered valid for specific types of resources on a web page</li>
</ul>
<h3 id="server-side-request-forgery-ssrf"><strong>Server-Side Request Forgery (SSRF)</strong><a aria-hidden="true" class="anchor-heading icon-link" href="#server-side-request-forgery-ssrf"></a></h3>
<p>SSRF flaws occur whenever a web application is fetching a remote resource without validating the user-supplied URL</p>
<h4 id="csrf">CSRF<a aria-hidden="true" class="anchor-heading icon-link" href="#csrf"></a></h4>
<p>Cross-Site Request Forgery (CSRF) is an attack that forces an end user to execute unwanted actions on a web application in which they’re currently authenticated. With a little help of social engineering (such as sending a link via email or chat), an attacker may trick the users of a web application into executing actions of the attacker’s choosing. If the victim is a normal user, a successful CSRF attack can force the user to perform state changing requests like transferring funds, changing their email address, and so forth. If the victim is an administrative account, CSRF can compromise the entire web application.</p>
<h3 id="vulnerable-and-outdated-components-previously-using-components-with-known-vulnerabilities">Vulnerable and Outdated Components (previously: Using Components with Known Vulnerabilities)<a aria-hidden="true" class="anchor-heading icon-link" href="#vulnerable-and-outdated-components-previously-using-components-with-known-vulnerabilities"></a></h3>
<p>Integrating outdated or vulnerable third-party components can expose applications to known exploits.</p>
<h4 id="example-6">Example:<a aria-hidden="true" class="anchor-heading icon-link" href="#example-6"></a></h4>
<ul>
<li>Including a vulnerable version of a library in an application, allowing attackers to exploit known weaknesses.</li>
</ul>
<h3 id="security-logging-and-monitoring-failures">Security Logging and Monitoring Failures<a aria-hidden="true" class="anchor-heading icon-link" href="#security-logging-and-monitoring-failures"></a></h3>
<p>Without proper logging and monitoring, detecting and responding to security incidents becomes challenging.</p>
<h4 id="example-7">Example:<a aria-hidden="true" class="anchor-heading icon-link" href="#example-7"></a></h4>
<ul>
<li>Failing to log failed login attempts, making it difficult to identify and respond to a brute-force attack.</li>
</ul>