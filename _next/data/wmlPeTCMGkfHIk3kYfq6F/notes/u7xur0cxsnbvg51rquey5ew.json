{"pageProps":{"note":{"id":"u7xur0cxsnbvg51rquey5ew","title":"Server and Client Composition Patterns","desc":"","updated":1755620615946,"created":1755620615946,"custom":{},"fname":"learning.nextjs.rendering.react-server-components.server-and-client-composition-patterns","type":"note","vault":{"fsPath":".","selfContained":true,"name":"Harshita-notes","sync":"sync"},"contentHash":"94a88dcdd37a036072259468b6c613ad","links":[],"anchors":{"server-components":{"type":"header","text":"Server components","value":"server-components","line":9,"column":0,"depth":2},"client-components":{"type":"header","text":"Client components","value":"client-components","line":15,"column":0,"depth":2},"server-component-patterns":{"type":"header","text":"Server component patterns","value":"server-component-patterns","line":27,"column":0,"depth":1},"server-only-code":{"type":"header","text":"Server-only code","value":"server-only-code","line":29,"column":0,"depth":2},"third-party-packages":{"type":"header","text":"Third party packages","value":"third-party-packages","line":46,"column":0,"depth":2},"context-providers":{"type":"header","text":"Context providers","value":"context-providers","line":58,"column":0,"depth":2},"client-component-patterns":{"type":"header","text":"Client component patterns","value":"client-component-patterns","line":68,"column":0,"depth":1},"client-only-code":{"type":"header","text":"Client only code","value":"client-only-code","line":70,"column":0,"depth":2}},"children":[],"parent":"ubgj4b3onoq9pj080dri1nj","data":{}},"body":"<h1 id=\"server-and-client-composition-patterns\">Server and Client Composition Patterns<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#server-and-client-composition-patterns\"></a></h1>\n<p>Scenarios where we can use client or server components.</p>\n<h2 id=\"server-components\">Server components<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#server-components\"></a></h2>\n<ul>\n<li>fetching data</li>\n<li>accessing backend resources directly</li>\n<li>keeping sensitive information (like access tokens and API keys) secure on the server</li>\n<li>handling large dependencies server-side - which means less JavaScript for your users to download</li>\n</ul>\n<h2 id=\"client-components\">Client components<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#client-components\"></a></h2>\n<ul>\n<li>adding interactivity</li>\n<li>handling event listeners (like onClick(), onChange(), etc.)</li>\n<li>managing state and lifecycle effects (using hooks like useState(), useReducer(), useEffect()) </li>\n<li>working with browser-specific APIs </li>\n<li>implementing custom hooks</li>\n<li>Using React class components</li>\n</ul>\n<p>But the differentiation isn't that black and white always. <strong>Here are some patterns to keep in mind:</strong></p>\n<h1 id=\"server-component-patterns\">Server component patterns<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#server-component-patterns\"></a></h1>\n<h2 id=\"server-only-code\">Server-only code<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#server-only-code\"></a></h2>\n<ul>\n<li>Some code is specifically designed to run exclusively on the server</li>\n<li>Think about modules or functions that work with multiple libraries, handle environment variables, communicate directly with databases, or process sensitive information.</li>\n<li>Since JavaScript modules can be shared between Server and Client Components, code meant for the server could accidentally find its way to the client</li>\n<li>This is bad news as it can bloat your JavaScript bundle, expose your secret keys, database queries, and sensitive business logic</li>\n</ul>\n<p>It's super important to keep server-only code separate from client-side code</p>\n<blockquote>\n<p>use <strong><em>server-only</em></strong> package. This throws a build time error if a someone accidentally imports server code into Client component.</p>\n</blockquote>\n<pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword module\">import</span> <span class=\"token string\">\"server-only\"</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h2 id=\"third-party-packages\">Third party packages<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#third-party-packages\"></a></h2>\n<ul>\n<li>Server Components have introduced an exciting new paradigm in React, and the ecosystem is evolving to keep up</li>\n<li>Third-party packages are starting to add the \"use client\" directive to components that need client-side features, making it clear where they should run</li>\n<li>Many npm packages haven't made this transition yet</li>\n<li>This means while they work fine in Client Components, they might break or fail completely in Server Components</li>\n<li>We can wrap the third-party components that need client-side features in our own Client Components: i.e, create a client component \"use client\" and use the third party package here, import this client component in server component instead of directly writing code of such third party packages in server component.</li>\n</ul>\n<h2 id=\"context-providers\">Context providers<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#context-providers\"></a></h2>\n<p>Context providers typically live near the root of an application to share global state and logic. For example, your application's theme.</p>\n<p>However, React context isn't supported in Server Components.</p>\n<p>If you try to create a context at your application's root, you'll run into an error. <strong>The solution is to create your context and render its provider inside a dedicated Client Component</strong></p>\n<ul>\n<li>Extracting the context provider and wrapping other server components as its children does not turn those server components into client components. Weâ€™ll dive deeper into this idea later when discussing client-side patterns.</li>\n</ul>\n<h1 id=\"client-component-patterns\">Client component patterns<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#client-component-patterns\"></a></h1>\n<h2 id=\"client-only-code\">Client only code<a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#client-only-code\"></a></h2>","noteIndex":{"id":"dlb5bmx7v8f6otsgongz4vx","title":"Hi","desc":"","updated":1663067414354,"created":1648190029829,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":".","selfContained":true,"name":"Harshita-notes","sync":"sync"},"contentHash":"5e58da66991a53ed4cf17d0cade77fe6","links":[{"type":"wiki","from":{"fname":"root","id":"dlb5bmx7v8f6otsgongz4vx","vaultName":"Harshita-notes"},"value":"user.tharshita13","alias":"@tharshita13","position":{"start":{"line":15,"column":12,"offset":433},"end":{"line":15,"column":24,"offset":445},"indent":[]},"xvault":false,"to":{"fname":"user.tharshita13"}}],"anchors":{"contacts":{"type":"header","text":"Contacts","value":"contacts","line":13,"column":0,"depth":2}},"children":["trkx8xrg7g2fm023ez4ldqj","c8csxid3zoghxorepwcrami","urj8q1uq98o3upmgbt2qxns","ddh1fz3o9jtwlnhx8im7w6n","xjtg1so5cq4qj3qoj1n357g","wcja9b2dozrw97bjfuc1ewj"],"parent":null,"data":{},"body":"\nHi,\nWelcome to Harshita's Digital Garden ðŸŒ±\nI'm Harshita Joshi. I'm a software engineer.\nWhen not at the computer, I play ukulele, do yoga, study [German](https://harshita-mindfire.github.io/german-for-beginners/) and wonder about having numerous pets.\n\n## Contacts\n\nYou can find and contact me in the following places\n\n- Email: tharshita13@gmail.com\n\n- Github: [Harshita-mindfire](https://github.com/Harshita-mindfire)\n\n- Medium: [@tharshita13](https://medium.com/@tharshita13)\n\n- LinkedIn: [Harshita Joshi](https://www.linkedin.com/in/harshita-joshi-030b29118/)\n\n- Instagram: [imharshita07](https://www.instagram.com/imharshita07/)\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true,"enableSelfContainedVaults":true,"enableEngineV3":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":".","selfContained":true,"name":"Harshita-notes","sync":"sync"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"task","dateFormat":"y.MM.dd","addBehavior":"asOwnDomain","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"taskCompleteStatus":["done","x"],"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableFullHierarchyNoteTitle":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Digital Garden","description":"Personal Knowledge Space"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"search","siteUrl":"https://Harshita-mindfire.github.io","assetsPrefix":"/Frontend-JsDev-Handbook","siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true}